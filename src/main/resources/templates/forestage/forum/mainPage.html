<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<title>影遇論壇首頁</title>
	<!-- Favicon-->
	<link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
	<!-- Bootstrap icons-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
	<!-- Google font -->
	<link href="https://fonts.googleapis.com/css2?family=Ysabeau+SC&display=swap" rel="stylesheet">
	<!-- Core theme CSS (includes Bootstrap)-->
	<link th:href="@{/forestage/forum/mainPage/css/styles.css}" rel="stylesheet" />
	<!-- 加入 jQuery -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<style>
		.card-img1 {
			object-fit: contain;
			/* 你可能還需要其他的CSS規則來控制大小，例如width、height等 */
		}
	</style>
</head>

<body class="d-flex flex-column h-100">
	<main class="flex-shrink-0">
		<!-- Navigation-->
		<div th:replace="~{forestage/shared/foreTopNav}"></div>
		<header class="bg-white py-4">
			<div class="container px-5">
				<!-- First row for the categories and search -->
				<div class="row gx-3 align-items-start justify-content-end">
					<!-- Search widget in its own column -->
					<div class="col-auto">
						<div class="input-group" style="width: auto; max-width: 300px;">
							<input class="form-control" type="text" placeholder="Enter search term..."
								aria-label="Enter search term..." aria-describedby="button-search" />
							<button class="btn btn-primary" id="button-search" type="button">Go!</button>
						</div>
					</div>
					<!-- First feature in its own column -->
					<div class="col-auto">
						<div class="mr-2">
							<ul class="list-unstyled mb-0">
								<li>
									<a th:href="@{/forum/article/add}">
										<img th:src="@{/forestage/forum/mainPage/assets/newArticle.png}" alt="新增貼文"
											width="125px" />
									</a>
								</li>
							</ul>
						</div>
					</div>
					<!-- Second feature in its own column -->
					<div class="col-auto">
						<div class="ml-2">
							<ul class="list-unstyled mb-0">
								<li>
									<a th:href="@{/myArticles}">
										<img th:src="@{/forestage/forum/mainPage/assets/myArticle.png}" alt="我的貼文"
											width="125px" />
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>


				<!-- Second row for the article content -->
				<div class="row gx-5 align-items-start justify-content-between">
					<div class="col-lg-12">
						<!-- Navigation tabs -->
						<ul class="nav nav-tabs">
							<li class="nav-item">
								<a class="nav-link active" id="new-articles-link" aria-current="page" href="#">最新文章</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" id="hot-articles-link" href="#">熱門文章</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="page3.html">精選文章</a>
							</li>
							<li class="nav-item">
								<a class="nav-link disabled">Disabled</a>
							</li>
						</ul>


						<!-- 新增的卡片程式碼部分 -->
						<div class="row mt-4"> <!-- 在這裡添加了 'mt-4'，這會產生一個上邊距（margin-top）-->
							<th:block th:each="article:${articleList}">
								<div class="col-lg-12">
									<!-- Blog post-->
									<div class="card mb-4">
										<div class="row no-gutters">
											<div class="col-md-4 d-flex align-items-center">
												<!-- 加上 d-flex align-items-center 來使圖片置中 -->
												<a href="#!" class="d-block mx-auto"> <!-- 加上 d-block mx-auto 來使圖片置中 -->
													<img th:src="@{/forum/article/{articleId}/image(articleId=${article.articleId})}"
														alt="..." class="card-img1" style="object-fit: contain;" />
													<!-- 加上 object-fit: contain; 來使圖片維持原始比例 -->
												</a>
											</div>
											<div class="col-md-8">
												<div class="card-body">
													<div class="text-muted" style="font-size: 18px;">
														發布於 <span
															th:text="${#dates.format(article.articlePostTime,'yyyy-MM-dd, HH:mm:ss')}"></span>
													</div>
													<h2 class="card-title h4"
														th:text="${article}?${article.articleTitle}">
													</h2>
													<!-- 要將CKEditor編輯器的內容正確顯示，而不只是純文字，可以在th:text標籤替換為th:utext。th:utext會將其內容作為未經過轉譯的HTML處理，而不是僅僅將其視為純文本 -->
													<p class="card-text"
														th:utext="${article}?${article.articleContent}">
													</p>
													<a class="btn btn-primary"
														th:href="@{'/forum/article/read/' + ${article.articleId}}">Read
														more →</a>
												</div>
											</div>
										</div>
									</div>
								</div>
							</th:block>
						</div>

						<nav aria-label="Page navigation example">
							<ul class="pagination justify-content-end paginationByWen">
								<li class="page-item" th:classappend="${articleList.first ? 'disabled' : ''}">
									<a class="page-link"
										th:href="@{/forum/article/mainPage(page=${articleList.number-1})}"
										aria-label="Previous">
										<span aria-hidden="true">&laquo;</span>
									</a>
								</li>
								<li class="page-item" th:each="item : ${#numbers.sequence(0, articleList.totalPages-1)}"
									th:classappend="${item==articleList.number ? 'active' : ''}">
									<a class="page-link" th:href="@{/forum/article/mainPage(page=${item})}"
										th:text="${item + 1}"></a>
								</li>
								<li class="page-item" th:classappend="${articleList.last ? 'disabled' : ''}">
									<a class="page-link"
										th:href="@{/forum/article/mainPage(page=${articleList.number+1})}"
										aria-label="Next">
										<span aria-hidden="true">&raquo;</span>
									</a>
								</li>
							</ul>
						</nav>
					</div>
				</div>
			</div>
		</header>




		<!-- Call to action-->
		<!-- <aside class="bg-primary bg-gradient rounded-3 p-4 p-sm-5 mt-5">
            <div
                class="d-flex align-items-center justify-content-between flex-column flex-xl-row text-center text-xl-start">
                <div class="mb-4 mb-xl-0">
                    <div class="fs-3 fw-bold text-white">New products, delivered to you.</div>
                    <div class="text-white-50">Sign up for our newsletter for the latest updates.</div>
                </div>
                <div class="ms-xl-4">
                    <div class="input-group mb-2">
                        <input class="form-control" type="text" placeholder="Email address..."
                            aria-label="Email address..." aria-describedby="button-newsletter" />
                        <button class="btn btn-outline-light" id="button-newsletter" type="button">Sign
                            up</button>
                    </div>
                    <div class="small text-white-50">We care about privacy, and will never share your data.
                    </div>
                </div>
            </div>
        </aside> -->


	</main>
	<script>
		$(document).ready(function () {
			function loadArticles(url) {
				$.ajax({
					url: url,
					type: 'GET',
					data: {
						page: 0
					},
					success: function (data) {
						var articleListDiv = $('.row.mt-4');
						articleListDiv.empty();
						for (var i = 0; i < data.length; i++) {
							var article = data[i];
							var articleDiv = $('<div class="card mb-4"></div>');
							var row = $('<div class="row no-gutters"></div>');
							var imgDiv = $('<div class="col-md-4 d-flex align-items-center"><a href="#!" class="d-block mx-auto"><img class="card-img1" src="data:image/png;base64,' + article.imageBase64 + '" alt="..." style="object-fit: contain;"></a></div>');
							row.append(imgDiv);
							var cardBodyDiv = $('<div class="col-md-8"><div class="card-body"></div></div>');
							var cardBody = cardBodyDiv.find('.card-body');
							cardBody.append('<div class="small text-muted">' + article.articlePostTime + '</div>');
							cardBody.append('<h2 class="card-title h4">' + article.articleTitle + '</h2>');
							cardBody.append('<p class="card-text">' + article.articleContent + '</p>');
							cardBody.append('<a class="btn btn-primary" href="/phocos/forum/article/read/' + article.articleId + '">Read more →</a>');
							row.append(cardBodyDiv);
							articleDiv.append(row);
							articleListDiv.append(articleDiv);
						}
					},
					error: function (jqXHR, textStatus, errorThrown) {
						console.error(textStatus, errorThrown);
					}
				});
			}

			loadArticles('http://localhost:8080/phocos/forum/article/mainPage/ajax');   // 頁面加載時取得最新文章的數據

			$('#hot-articles-link').on('click', function (e) {
				e.preventDefault();
				$('button, .nav-link').removeClass('active');
				$(this).addClass('active');
				loadArticles('http://localhost:8080/phocos/forum/article/hotArticles');  // 點擊「熱門文章」時取得熱門文章的數據
			});
			$('#new-articles-link').on('click', function (e) {
				e.preventDefault();
				$('button, .nav-link').removeClass('active');
				$(this).addClass('active');
				loadArticles('http://localhost:8080/phocos/forum/article/mainPage/ajax');  // 點擊「最新文章」時重新取得最新文章的數據
			});

		});

	</script>

	<div class="container">
		<div class="row justify-content-center">
			<div class="col-md-6">
				<div class="card mb-4">
					<div class="card-header">
						<h2>我的小畫布</h2>
					</div>
					<div class="card-body">
						<select id="colorSelector" class="form-select mb-2" style="width: 200px;">
							<option value="black">黑色</option>
							<option value="blue">藍色</option>
							<option value="red">紅色</option>
							<option value="green">綠色</option>
							<option value="yellow">黃色</option>
							<option value="orange">橘色</option>
							<option value="purple">紫色</option>
							<option value="pink">粉紅色</option>
							<option value="brown">棕色</option>
							<option value="gray">灰色</option>
						</select>
						<div id="drawArea" style="height: 300px; width: 300px; border: 1px solid black; margin: auto;">
							<canvas id="game-canvas" width="300" height="300"></canvas>
						</div>
						<button id="clearCanvas" class="btn btn-danger mt-2 d-block mx-auto">清除畫布</button>
						<button id="downloadButton" class="btn btn-success mt-2 d-block mx-auto">下載畫作</button>
					</div>
				</div>
			</div>
		</div>
	</div>



	<script>

	</script>

	<!-- Footer-->
	<div th:replace="~{forestage/shared/foreFooter}"></div>
	<!-- Bootstrap core JS-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- Game script -->
	<script th:src="@{/forestage/forum/mainPage/js/game.js}"></script>

	<!-- Core theme JS-->
	<script th:src="@{/forestage/forum/mainPage/js/scripts.js}"></script>
</body>

</html>